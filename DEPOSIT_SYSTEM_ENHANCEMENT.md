# نظام الإيداع المحسن - Es-Gift 💰

## 🎯 الميزة الجديدة

تم تحسين نظام الإيداع في المحفظة ليدعم طرق دفع مختلفة حسب العملة المختارة:

### 💳 **للريال السعودي (SAR)**
- **طريقة الدفع**: تحويل بنكي فقط
- **البيانات المعروضة**: تفاصيل الحساب البنكي كاملة
- **المعلومات**: 
  - اسم البنك: البنك الأهلي السعودي
  - اسم المستفيد: شركة إس جيفت للهدايا الرقمية
  - رقم الحساب: SA12 1000 0012 3456 7890 1234
  - رقم الآيبان: SA12 1000 0012 3456 7890 1234

### 🪙 **للدولار الأمريكي (USD)**
- **طريقة الدفع**: USDT عبر شبكة TRC20
- **البيانات المعروضة**: عنوان محفظة USDT
- **المعلومات**:
  - نوع العملة: USDT (Tether)
  - الشبكة: TRC20 (TRON)
  - عنوان المحفظة: TQz8xvWKmpLgGrza5pXcZECyPfWzNEXxzf
- **متطلب إضافي**: رفع صورة إثبات التحويل

---

## 🔧 التحسينات المطبقة

### 1. **واجهة المستخدم**
- ✅ عرض طريقة دفع تلقائية حسب العملة
- ✅ بيانات بنكية واضحة للريال
- ✅ بيانات محفظة USDT للدولار
- ✅ أزرار نسخ سريعة للبيانات المهمة
- ✅ رفع صورة إثبات للعملات المشفرة

### 2. **النظام الخلفي**
- ✅ إضافة حقل `transaction_proof` لحفظ مسار الصورة
- ✅ التحقق من رفع الصورة للعملات المشفرة
- ✅ حفظ آمن للملفات مع أسماء فريدة
- ✅ دعم صيغ الصور: PNG, JPG, JPEG, GIF

### 3. **لوحة الإدارة**
- ✅ عرض صورة إثبات المعاملة
- ✅ مودال لعرض الصورة بحجم كامل
- ✅ خيار تحميل الصورة
- ✅ تمييز طرق الدفع بأيقونات واضحة

---

## 📁 الملفات المُحدثة

### **القوالب (Templates)**
1. `templates/wallet/deposit.html`
   - إضافة دالة `updatePaymentMethods()`
   - إضافة أقسام البيانات البنكية والعملات المشفرة
   - التحقق من رفع الصورة

2. `templates/admin/deposit_request_details.html`
   - عرض صورة إثبات المعاملة
   - مودال عرض الصورة
   - خيار تحميل الصورة

3. `templates/wallet/deposit_requests.html`
   - تحسين عرض طرق الدفع

4. `templates/admin/wallet_deposit_requests.html`
   - تحسين عرض طرق الدفع

### **الكود الخلفي (Backend)**
1. `wallet_routes.py`
   - التعامل مع رفع الملفات
   - حفظ آمن للصور
   - التحقق من أنواع الملفات

2. `models.py`
   - إضافة حقل `transaction_proof`

3. `add_transaction_proof_field.py`
   - سكريبت تحديث قاعدة البيانات

---

## 🚀 كيفية الاستخدام

### **للمستخدمين**

#### إيداع بالريال السعودي:
1. اختر "SAR" من قائمة العملات
2. ستظهر تلقائياً بيانات الحساب البنكي
3. انسخ البيانات واستخدمها للتحويل
4. أرسل طلب الإيداع
5. انتظر تأكيد الإدارة (1-3 أيام عمل)

#### إيداع بالدولار الأمريكي:
1. اختر "USD" من قائمة العملات
2. ستظهر تلقائياً بيانات محفظة USDT
3. أرسل USDT للعنوان المحدد عبر شبكة TRC20
4. **مهم**: ارفع صورة إثبات التحويل
5. أرسل طلب الإيداع
6. انتظر موافقة الإدارة (24 ساعة)

### **للإدارة**
1. راجع طلبات الإيداع من لوحة الإدارة
2. للعملات المشفرة: اطلع على صورة إثبات المعاملة
3. تأكد من صحة التحويل
4. اقبل أو ارفض الطلب مع إضافة ملاحظات

---

## ⚠️ تنبيهات مهمة

### **للريال السعودي**
- ⚠️ تأكد من كتابة اسمك الكامل في وصف التحويل
- ⚠️ احتفظ بإيصال التحويل للمراجعة
- ⚠️ المعالجة تستغرق 1-3 أيام عمل

### **للعملات المشفرة**
- 🚨 **استخدم شبكة TRC20 فقط** - أي شبكة أخرى ستؤدي لفقدان الأموال
- 🚨 تأكد من إرسال USDT وليس أي عملة أخرى
- 🚨 يجب رفع صورة إثبات التحويل
- 🚨 تأكد من المبلغ المرسل بالضبط

---

## 🔒 الأمان

- ✅ التحقق من نوع الملفات المرفوعة
- ✅ أسماء ملفات آمنة ومشفرة
- ✅ حد أقصى لحجم الملف (5MB)
- ✅ حفظ الملفات في مجلد محمي
- ✅ سجل كامل لجميع المعاملات

---

## 📞 الدعم الفني

في حالة وجود أي مشاكل:
1. تأكد من اتباع التعليمات بدقة
2. راجع رسائل الخطأ المعروضة
3. تواصل مع الدعم الفني مع إرفاق:
   - رقم الطلب
   - لقطة شاشة للخطأ
   - تفاصيل الخطوات المتبعة

---

*تم التطوير والاختبار بنجاح ✅*

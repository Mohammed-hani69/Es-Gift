# ES-Gift - نظام إدارة الهدايا الرقمية (محدث 2025)

## 📋 نظرة عامة
ES-Gift هو تطبيق ويب شامل لإدارة الهدايا الرقمية وبطاقات الألعاب، مبني باستخدام Flask ومصمم خصيصاً للسوق العربي مع نظام تصميم حديث ومتطور.

## ✨ أحدث التحديثات (يوليو 2025)

### 🎨 نظام التصميم الموحد الجديد
- **Design System**: نظام تصميم شامل مع متغيرات CSS موحدة
- **مكونات قابلة للإعادة**: بطاقات، أزرار، وعناصر تفاعلية موحدة
- **ألوان متناسقة**: لوحة ألوان احترافية مع التدرج الأحمر المميز
- **تأثيرات متقدمة**: رسوم متحركة وتأثيرات تفاعلية محسنة

### 🔄 تحسينات صفحة "طلباتي"
- **تصميم معاد تماماً**: واجهة حديثة مع خلفيات متحركة
- **بطاقات تفاعلية**: تأثيرات hover وانتقالات سلسة
- **شارات الحالة**: تصميم محسن لحالات الطلبات
- **استجابة كاملة**: تصميم محسن للهواتف والأجهزة اللوحية

### �️ إصلاح مشاكل النشر (أغسطس 2025)
- **ملف WSGI محسن**: حل مشكلة `ModuleNotFoundError: No module named 'app'`
- **نص نشر محدث**: `deploy.sh` مع فحوصات شاملة
- **أدوات فحص**: `check_deployment.py` للتحقق من جاهزية النشر
- **اختبارات شاملة**: `test_app.py` لاختبار جميع المكونات
- **دعم Gunicorn**: إعدادات محسنة للخادم

### �🚀 تحسينات الأداء
- **تأثيرات مؤجلة**: تحميل التأثيرات فقط عند الحاجة
- **تحسين الذاكرة**: إدارة أفضل للرسوم المتحركة
## 🚀 البدء السريع

### التشغيل السريع (للتطوير):
```bash
# 1. تشغيل النظام التفاعلي
python run_es_gift.py

# 2. أو تشغيل مباشر
python app.py
```

### النشر على الخادم:

#### Linux/Unix:
```bash
# 1. فحص جاهزية النشر
python check_deployment.py

# 2. النشر
./deploy.sh

# 3. التشغيل
gunicorn -w 4 -b 127.0.0.1:8000 wsgi:application
```

#### Windows:
```bash
# 1. فحص جاهزية النشر
python check_deployment.py

# 2. تثبيت Waitress
pip install waitress

# 3. التشغيل
waitress-serve --port=8000 wsgi:application
```

### 🔧 أوامر مفيدة:
```bash
# اختبار التطبيق
python test_app.py

# فحص الإعدادات
gunicorn --check-config wsgi:application

# تشغيل تفاعلي كامل
python run_es_gift.py
```

- **تحميل تدريجي**: ظهور العناصر بشكل متدرج ومتناسق

### 🎯 تجربة المستخدم المحسنة
- **تفاعل بصري**: ردود فعل فورية للنقرات والتفاعلات
- **إشارات بصرية**: مؤشرات واضحة للحالات والإجراءات
- **تنقل محسن**: تجربة سلسة عبر جميع الصفحات

### 👥 إدارة المستخدمين المحسنة
- **إنشاء مستخدمين آمن**: نموذج محسن مع تحقق متقدم من البيانات
- **مؤشر قوة كلمة المرور**: عرض قوة كلمة المرور في الوقت الفعلي
- **أنواع الحسابات**: دعم للحسابات العادية والموزعين
- **نظام KYC**: إدارة متقدمة لحالة التحقق من الهوية

### 💬 نظام الدعم الفني المباشر
- **شات مباشر**: أيقونة عائمة للتواصل الفوري مع الدعم الفني
- **دعم Tawk.to**: نظام شات متقدم مع إمكانيات تتبع المحادثات
- **معلومات المستخدم**: إرسال تلقائي لمعلومات المستخدم عند بدء المحادثة
- **متاح 24/7**: دعم فني على مدار الساعة

## 🛠 الهيكل التقني الجديد

### 📁 ملفات التصميم
```
static/css/
├── design-system.css      # نظام التصميم الجديد
├── style.css             # الأنماط الأساسية
└── header-footer-enhanced.css

docs/
├── design-system-improvements.md  # توثيق التحسينات
└── chat-system-update.md
```

### 🎨 مكونات التصميم
- `.es-card` - بطاقات موحدة مع تأثيرات
- `.es-btn` - أزرار بتصميم حديث ومتغيرات
- `.es-status-badge` - شارات الحالة التفاعلية
- `.es-grid` - نظام شبكة مرن ومتجاوب

## � التشغيل السريع

### 1. تثبيت المتطلبات
```bash
pip install flask flask-sqlalchemy flask-login werkzeug
```

### 2. تشغيل التطبيق
```bash
python test_run.py
```

### 3. الوصول للنظام
- **الموقع الرئيسي**: https://es-gift.com
- **لوحة الإدارة**: https://es-gift.com/admin
- **بيانات الدخول الافتراضية**:
  - البريد الإلكتروني: `admin@es-gift.com`
  - كلمة المرور: `admin123`
- **Email:** Flask-Mail
- **Authentication:** Flask-Login
- **File Upload:** Werkzeug
- **API Integration:** Requests

## 📦 التثبيت والتشغيل

# 1. إضافة جميع الملفات المعدلة إلى قائمة التتبع
git add .

# 2. عمل commit مع رسالة توضيحية (غيّر الرسالة لما يناسب التحديث)
git commit -m "v 1.4.2"

# 3. رفع التحديثات إلى الريموت (GitHub)
git push origin main

### 1. متطلبات النظام
```bash
Python 3.8+
pip
```

### 2. تحميل المشروع
```bash
git clone [repository-url]
cd es-gift
```

### 3. تثبيت المكتبات المطلوبة
```bash
pip install -r requirements.txt
```

### 4. إعداد متغيرات البيئة
انسخ ملفات الإعداد المثال وقم بتعديل القيم:
```bash
cp .env.example .env
cp google_client_secrets.json.example google_client_secrets.json
```

قم بتعديل ملف `.env` وإضافة:
- إعدادات البريد الإلكتروني (Gmail أو SMTP مخصص)
- مفاتيح Google OAuth (Client ID & Secret)
- بيانات OneCard API
- أرقام واتساب للدعم

قم بتعديل ملف `google_client_secrets.json` وإضافة:
- Google Client ID و Client Secret
- Project ID من Google Cloud Console
- URLs للـ redirect الصحيحة

### 5. تشغيل التطبيق
```bash
python app.py
```

سيكون التطبيق متاحاً على: `https://es-gift.com`

## 🔧 الإعدادات الأولية

### إنشاء حساب المدير
عند أول تشغيل، سيتم إنشاء حساب مدير افتراضي:
- **البريد الإلكتروني:** admin@es-gift.com
- **كلمة المرور:** admin123

**⚠️ يجب تغيير كلمة المرور فور تسجيل الدخول**

### إعداد البريد الإلكتروني
1. قم بتفعيل "التحقق بخطوتين" في جوجل
2. أنشئ "كلمة مرور تطبيق" جديدة
3. أضف البيانات في ملف `.env`

### إعداد بوابات الدفع
1. ادخل على لوحة التحكم
2. انتقل إلى "بوابات الدفع"
3. أضف وأعد بوابات الدفع المطلوبة

## 📱 لوحة التحكم

### الوصول للوحة التحكم
`https://es-gift.com/admin`

### الأقسام الرئيسية:
- **الرئيسية:** إحصائيات ونظرة عامة
- **المنتجات:** إدارة المنتجات والأكواد
- **المستخدمين:** إدارة الحسابات
- **الطلبات:** متابعة الطلبات والمدفوعات
- **طلبات التحقق:** مراجعة طلبات KYC
- **العملات:** إدارة أسعار الصرف
- **بوابات الدفع:** إدارة طرق الدفع والعمولات
- **إعدادات API:** ربط مع APIs خارجية
- **المقالات:** إدارة المحتوى

## 🔐 الأمان

### الممارسات الأمنية:
- تشفير كلمات المرور
- حماية من CSRF
- تنظيف المدخلات
- تأمين رفع الملفات
- حماية جلسات المستخدمين

### ⚠️ ملفات الإعداد الحساسة:
- **لا تشارك** ملف `.env` أو `google_client_secrets.json` مطلقاً
- هذه الملفات مستثناة من Git عبر `.gitignore`
- استخدم ملفات `.example` كمرجع للإعداد
- تأكد من تحديث القيم الافتراضية قبل النشر للإنتاج

### النسخ الاحتياطية:
- نسخ احتياطي يومي لقاعدة البيانات
- نسخ احتياطي للملفات المرفوعة  
- مراقبة الأنشطة المشبوهة

## 🌐 النشر للإنتاج

### متطلبات الخادم:
- Ubuntu 20.04+ أو CentOS 8+
- Python 3.8+
- Nginx
- SSL Certificate

### خطوات النشر:
1. رفع الملفات للخادم
2. تثبيت المكتبات المطلوبة
3. إعداد قاعدة البيانات
4. إعداد Nginx
5. إعداد SSL
6. تشغيل التطبيق باستخدام Gunicorn

### أوامر النشر:

#### للخوادم Linux/Unix:
```bash
# تثبيت Gunicorn
pip install gunicorn

# تشغيل التطبيق
gunicorn -w 4 -b 127.0.0.1:8000 wsgi:application
```

#### لـ Windows (التطوير والاختبار):
```bash
# تثبيت Waitress (بديل Gunicorn لـ Windows)
pip install waitress

# تشغيل التطبيق
waitress-serve --port=8000 wsgi:application
```

## 🐛 استكشاف الأخطاء

### المشاكل الشائعة:

#### 🚀 مشاكل النشر والـ Gunicorn:

**1. خطأ `ModuleNotFoundError: No module named 'app'`**
```bash
# الحل: استخدم wsgi:application بدلاً من app:app
gunicorn -w 4 -b 127.0.0.1:8000 wsgi:application
```

**2. خطأ `ModuleNotFoundError: No module named 'fcntl'` على Windows**
```bash
# المشكلة: Gunicorn لا يعمل على Windows
# الحل: استخدم Waitress بدلاً من Gunicorn
pip install waitress
waitress-serve --port=8000 wsgi:application
```

**3. خطأ `ModuleNotFoundError: No module named 'run_es_gift'`**
```bash
# الحل: تأكد من وجود wsgi.py صحيح
python check_deployment.py  # للفحص
```

**4. فحص جاهزية النشر:**
```bash
python check_deployment.py
python test_app.py
```

**5. تشغيل آمن للإنتاج:**

Linux/Unix:
```bash
# فحص الإعدادات أولاً
gunicorn --check-config wsgi:application

# ثم التشغيل
gunicorn -w 4 -b 127.0.0.1:8000 wsgi:application
```

Windows:
```bash
# تشغيل مباشر للتطوير
python app.py

# أو استخدام Waitress للإنتاج
waitress-serve --port=8000 wsgi:application
```

#### 🗄️ مشاكل قاعدة البيانات:
1. **خطأ في الاتصال بقاعدة البيانات**
   - تأكد من صحة مسار قاعدة البيانات
   - تأكد من صلاحيات الكتابة

2. **خطأ في إرسال البريد الإلكتروني**
   - تأكد من إعدادات SMTP
   - تأكد من كلمة مرور التطبيق

3. **خطأ في رفع الملفات**
   - تأكد من وجود مجلد uploads
   - تأكد من صلاحيات الكتابة

## 📞 الدعم

للحصول على الدعم أو الإبلاغ عن الأخطاء:
- البريد الإلكتروني: support@es-gift.com
- واتساب: +201145425207

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT - راجع ملف [LICENSE](LICENSE) للتفاصيل.

## 🤝 المساهمة

نرحب بالمساهمات! يرجى اتباع هذه الخطوات:
1. Fork المشروع
2. إنشاء branch للميزة الجديدة
3. Commit التغييرات
4. Push للـ branch
5. إنشاء Pull Request

---

تم تطوير هذا المشروع بواسطة فريق ES-Gift Development Team 🚀
{% extends "admin/base.html" %}

{% block page_title %}Ù…Ù†ØªØ¬Ø§Øª API - {{ api_setting.api_name }}{% endblock %}

{% block content %}
<div class="content-card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>
            <i class="fas fa-box"></i>
            Ù…Ù†ØªØ¬Ø§Øª API - {{ api_setting.api_name }}
        </h2>
        <div>
            <button class="btn btn-info" onclick="refreshLiveProducts()">
                <i class="fas fa-refresh"></i>
                ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø±
            </button>
            <button class="btn btn-warning" onclick="testProducts()">
                <i class="fas fa-flask"></i>
                Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            </button>
            <button class="btn btn-success" onclick="syncProducts()">
                <i class="fas fa-sync"></i>
                Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            </button>
            <a href="{{ url_for('api_admin.api_settings') }}" class="btn btn-primary">
                <i class="fas fa-arrow-right"></i>
                Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            </a>
        </div>
    </div>

    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø§Ù„Ø© API -->
    {% if api_status == 'error' %}
    <div class="alert alert-danger">
        <i class="fas fa-exclamation-triangle"></i>
        <strong>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API:</strong> {{ api_error }}
        <br><small>ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ ({{ saved_products_count }} Ù…Ù†ØªØ¬)</small>
    </div>
    {% elif live_products_count > 0 %}
    <div class="alert alert-success">
        <i class="fas fa-check-circle"></i>
        <strong>ØªÙ… Ø¬Ù„Ø¨ {{ live_products_count }} Ù…Ù†ØªØ¬ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† OneCard API</strong>
        {% if saved_products_count > 0 %}
        <br><small>ÙŠÙˆØ¬Ø¯ {{ saved_products_count }} Ù…Ù†ØªØ¬ Ù…Ø­ÙÙˆØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹</small>
        {% endif %}
    </div>
    {% endif %}

    <div class="stats-row">
        <div class="stat-card">
            <div class="stat-number">{{ products|length }}</div>
            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ products|selectattr('is_test_product', 'equalto', true)|list|length }}</div>
            <div class="stat-label">Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ products|selectattr('is_imported', 'equalto', true)|list|length }}</div>
            <div class="stat-label">Ù…Ù†ØªØ¬Ø§Øª Ù…Ø³ØªÙˆØ±Ø¯Ø©</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ products|selectattr('stock_status', 'equalto', true)|list|length }}</div>
            <div class="stat-label">Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†</div>
        </div>
    </div>

    <div class="filters-section">
        <div class="filter-group">
            <input type="text" id="searchInput" placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª..." class="form-control">
        </div>
        <div class="filter-group">
            <select id="categoryFilter" class="form-control">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                {% for category in products|map(attribute='category')|unique %}
                <option value="{{ category }}">{{ category }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="filter-group">
            <select id="statusFilter" class="form-control">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                <option value="imported">Ù…Ø³ØªÙˆØ±Ø¯</option>
                <option value="not_imported">ØºÙŠØ± Ù…Ø³ØªÙˆØ±Ø¯</option>
                <option value="in_stock">Ù…ØªÙˆÙØ±</option>
                <option value="out_of_stock">ØºÙŠØ± Ù…ØªÙˆÙØ±</option>
                <option value="test_products">Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</option>
            </select>
        </div>
    </div>

    <div class="table-container">
        <table class="data-table" id="productsTable">
            <thead>
                <tr>
                    <th>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
                    <th>Ø§Ù„ÙØ¦Ø©</th>
                    <th>Ø§Ù„Ø³Ø¹Ø±</th>
                    <th>Ø§Ù„Ø¹Ù…Ù„Ø©</th>
                    <th>Ø§Ù„Ù…Ø®Ø²Ù†</th>
                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                <tr data-category="{{ product.category }}" 
                    data-imported="{{ product.is_imported|lower }}" 
                    data-stock="{{ product.stock_status|lower }}"
                    data-test="{{ product.is_test_product|lower if product.is_test_product is defined else 'false' }}">
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <strong>{{ product.name }}</strong>
                            {% if product.is_test_product is defined and product.is_test_product %}
                            <span class="badge badge-test">Ø§Ø®ØªØ¨Ø§Ø±</span>
                            {% endif %}
                        </div>
                        {% if product.description %}
                        <small class="text-muted">{{ product.description[:100] }}...</small>
                        {% endif %}
                        <br><small class="text-info">ID: {{ product.external_product_id }}</small>
                    </td>
                    <td>{{ product.category or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</td>
                    <td><strong>{{ product.price }}</strong></td>
                    <td>{{ product.currency }}</td>
                    <td>
                        <span class="status-badge {{ 'status-approved' if product.stock_status else 'status-rejected' }}">
                            {{ 'Ù…ØªÙˆÙØ±' if product.stock_status else 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}
                        </span>
                    </td>
                    <td>
                        {% if product.is_imported %}
                        <span class="status-badge status-approved">
                            Ù…Ø³ØªÙˆØ±Ø¯
                        </span>
                        {% if product.local_product %}
                        <br><small>Ù…Ù†ØªØ¬ #{{ product.local_product.id }}</small>
                        {% endif %}
                        {% else %}
                        <span class="status-badge status-pending">
                            ØºÙŠØ± Ù…Ø³ØªÙˆØ±Ø¯
                        </span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="action-buttons">
                            {% if not product.is_imported %}
                            <button class="btn btn-sm btn-success" 
                                    onclick="importProduct('{{ product.external_product_id }}')" 
                                    title="Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙƒÙ…Ù†ØªØ¬ Ù…Ø­Ù„ÙŠ">
                                <i class="fas fa-download"></i>
                            </button>
                            {% endif %}
                            
                            <button class="btn btn-sm btn-info" 
                                    onclick="viewProductDetails('{{ product.external_product_id }}')" 
                                    title="Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„">
                                <i class="fas fa-eye"></i>
                            </button>
                            
                            {% if product.local_product %}
                            <a href="{{ url_for('admin.edit_product', product_id=product.local_product.id) }}" 
                               class="btn btn-sm btn-primary" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø­Ù„ÙŠ">
                                <i class="fas fa-edit"></i>
                            </a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="7" class="text-center">
                        <div style="padding: 40px;">
                            <i class="fas fa-box-open" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                            <h4>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ø¹Ø±Ø¶</h4>
                            <p class="text-muted">Ù‚Ù… Ø¨Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† OneCard API Ø£Ùˆ ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</p>
                            <button class="btn btn-primary" onclick="refreshLiveProducts()">
                                <i class="fas fa-sync"></i>
                                Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¢Ù†
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Modal Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ -->
<div id="productModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h3>
            <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <div class="modal-body" id="modalBody">
            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
        </div>
    </div>
</div>

<script>
// Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† OneCard
function refreshLiveProducts() {
    const button = event.target;
    const originalHTML = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...';
    button.disabled = true;
    
    fetch(`/admin/api/live-products/{{ api_setting.id }}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(`ØªÙ… Ø¬Ù„Ø¨ ${data.data.length} Ù…Ù†ØªØ¬ Ù…Ù† Ø£ØµÙ„ ${data.total_count} Ù…Ù†ØªØ¬ Ù…ØªØ§Ø­`, 'success');
            setTimeout(() => {
                location.reload();
            }, 2000);
        } else {
            showAlert('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ' + data.message, 'error');
        }
    })
    .catch(error => {
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ' + error.message, 'error');
    })
    .finally(() => {
        button.innerHTML = originalHTML;
        button.disabled = false;
    });
}

// Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
function testProducts() {
    const button = event.target;
    const originalHTML = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
    button.disabled = true;
    
    fetch(`/admin/api/test-products/{{ api_setting.id }}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            let message = 'Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:\n\n';
            const results = data.data;
            let successCount = 0;
            let errorCount = 0;
            
            Object.keys(results).forEach(productId => {
                const result = results[productId];
                if (result.status === 'success') {
                    message += `âœ… Ø§Ù„Ù…Ù†ØªØ¬ ${productId}: ${result.name} - ${result.price} SAR\n`;
                    successCount++;
                } else {
                    message += `âŒ Ø§Ù„Ù…Ù†ØªØ¬ ${productId}: ${result.message}\n`;
                    errorCount++;
                }
            });
            
            message += `\nğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${successCount} Ù†Ø§Ø¬Ø­ØŒ ${errorCount} ÙØ§Ø´Ù„`;
            
            showAlert(message, successCount > errorCount ? 'success' : 'warning');
        } else {
            showAlert('ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ' + data.message, 'error');
        }
    })
    .catch(error => {
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ' + error.message, 'error');
    })
    .finally(() => {
        button.innerHTML = originalHTML;
        button.disabled = false;
    });
}

function syncProducts() {
    const button = event.target;
    const originalHTML = button.innerHTML;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©...';
    button.disabled = true;
    
    fetch(`/admin/api/sync/{{ api_setting.id }}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showAlert(data.message, 'success');
            setTimeout(() => {
                location.reload();
            }, 2000);
        } else {
            showAlert('ÙØ´Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©: ' + data.message, 'error');
        }
    })
    .catch(error => {
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©: ' + error.message, 'error');
    })
    .finally(() => {
        button.innerHTML = originalHTML;
        button.disabled = false;
    });
}

function importProduct(productId) {
    if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ÙƒÙ…Ù†ØªØ¬ Ù…Ø­Ù„ÙŠØŸ')) {
        const button = event.target.closest('button');
        const originalHTML = button.innerHTML;
        button.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        button.disabled = true;
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹
        fetch(`/admin/api/import-product-by-external-id/${productId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify({'api_settings_id': {{ api_setting.id }}})
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                showAlert(data.message, 'success');
                setTimeout(() => {
                    location.reload();
                }, 2000);
            } else {
                showAlert('ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯: ' + data.message, 'error');
                button.innerHTML = originalHTML;
                button.disabled = false;
            }
        })
        .catch(error => {
            showAlert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯: ' + error.message, 'error');
            button.innerHTML = originalHTML;
            button.disabled = false;
        });
    }
}

function viewProductDetails(productId) {
    // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† OneCard Ù…Ø¨Ø§Ø´Ø±Ø©
    fetch(`/admin/api/onecard-product-details/{{ api_setting.id }}/${productId}`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const product = data.data;
            const isTestProduct = ['3770', '3771', '3772', '3773', '3774'].includes(productId);
            
            document.getElementById('modalBody').innerHTML = `
                <div class="product-details">
                    <h4>${product.name || product.productName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</h4>
                    ${isTestProduct ? '<span class="badge badge-test" style="margin-bottom: 10px;">Ù…Ù†ØªØ¬ Ø§Ø®ØªØ¨Ø§Ø±</span>' : ''}
                    <p><strong>Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ:</strong> ${productId}</p>
                    <p><strong>Ø§Ù„ÙØ¦Ø©:</strong> ${product.category || product.categoryName || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                    <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> ${product.price || product.sellingPrice || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'} ${product.currency || 'SAR'}</p>
                    <p><strong>Ø§Ù„ÙˆØµÙ:</strong> ${product.description || product.productDescription || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</p>
                    <p><strong>Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø®Ø²Ù†:</strong> ${product.inStock !== false ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</p>
                    <p><strong>ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…:</strong> ${new Date().toLocaleString('ar')}</p>
                    <details>
                        <summary>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… Ù…Ù† OneCard</summary>
                        <pre>${JSON.stringify(product, null, 2)}</pre>
                    </details>
                </div>
            `;
            document.getElementById('productModal').style.display = 'flex';
        } else {
            showAlert('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬: ' + data.message, 'error');
        }
    })
    .catch(error => {
        showAlert('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„: ' + error.message, 'error');
    });
}

function closeModal() {
    document.getElementById('productModal').style.display = 'none';
}

// ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
document.getElementById('searchInput').addEventListener('input', filterProducts);
document.getElementById('categoryFilter').addEventListener('change', filterProducts);
document.getElementById('statusFilter').addEventListener('change', filterProducts);

function filterProducts() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const categoryFilter = document.getElementById('categoryFilter').value;
    const statusFilter = document.getElementById('statusFilter').value;
    
    const rows = document.querySelectorAll('#productsTable tbody tr');
    
    rows.forEach(row => {
        const productName = row.querySelector('td:first-child').textContent.toLowerCase();
        const category = row.dataset.category;
        const isImported = row.dataset.imported === 'true';
        const inStock = row.dataset.stock === 'true';
        const isTestProduct = row.dataset.test === 'true';
        
        let showRow = true;
        
        // ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø«
        if (searchTerm && !productName.includes(searchTerm)) {
            showRow = false;
        }
        
        // ÙÙ„ØªØ± Ø§Ù„ÙØ¦Ø©
        if (categoryFilter && category !== categoryFilter) {
            showRow = false;
        }
        
        // ÙÙ„ØªØ± Ø§Ù„Ø­Ø§Ù„Ø©
        if (statusFilter) {
            switch(statusFilter) {
                case 'imported':
                    if (!isImported) showRow = false;
                    break;
                case 'not_imported':
                    if (isImported) showRow = false;
                    break;
                case 'in_stock':
                    if (!inStock) showRow = false;
                    break;
                case 'out_of_stock':
                    if (inStock) showRow = false;
                    break;
                case 'test_products':
                    if (!isTestProduct) showRow = false;
                    break;
            }
        }
        
        row.style.display = showRow ? '' : 'none';
    });
}

function showAlert(message, type) {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
    alertDiv.style.position = 'fixed';
    alertDiv.style.top = '20px';
    alertDiv.style.right = '20px';
    alertDiv.style.zIndex = '9999';
    alertDiv.style.minWidth = '300px';
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="close" onclick="this.parentElement.remove()">
            <span>&times;</span>
        </button>
    `;
    document.body.appendChild(alertDiv);
    
    setTimeout(() => {
        if (alertDiv.parentElement) {
            alertDiv.remove();
        }
    }, 5000);
}
</script>

<style>
.stats-row {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
}

.stat-card {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    flex: 1;
}

.stat-number {
    font-size: 2em;
    font-weight: bold;
    color: #007bff;
}

.stat-label {
    color: #6c757d;
    margin-top: 5px;
}

.filters-section {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.filter-group {
    flex: 1;
    min-width: 200px;
}

.action-buttons {
    display: flex;
    gap: 5px;
    flex-wrap: wrap;
}

.action-buttons .btn {
    min-width: 32px;
}

.status-badge {
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.75em;
    font-weight: bold;
}

.status-approved {
    background-color: #28a745;
    color: white;
}

.status-pending {
    background-color: #ffc107;
    color: #212529;
}

.status-rejected {
    background-color: #dc3545;
    color: white;
}

.text-muted {
    color: #6c757d;
}

.text-info {
    color: #17a2b8;
    font-family: monospace;
}

.badge {
    display: inline-block;
    padding: 3px 8px;
    font-size: 0.75em;
    font-weight: bold;
    border-radius: 12px;
}

.badge-test {
    background-color: #ff9800;
    color: white;
}

.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
}

.modal-content {
    background: white;
    border-radius: 8px;
    width: 90%;
    max-width: 600px;
    max-height: 80%;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid #dee2e6;
}

.modal-body {
    padding: 20px;
}

.close {
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #aaa;
}

.close:hover {
    color: #000;
}

.product-details h4 {
    color: #007bff;
    margin-bottom: 15px;
}

.product-details p {
    margin-bottom: 10px;
}

details {
    margin-top: 15px;
}

summary {
    cursor: pointer;
    font-weight: bold;
    color: #007bff;
}

pre {
    background: #f8f9fa;
    padding: 10px;
    border-radius: 4px;
    font-size: 0.85em;
    overflow-x: auto;
}
</style>
{% endblock %}
